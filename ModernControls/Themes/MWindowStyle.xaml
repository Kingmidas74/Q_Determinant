<ResourceDictionary 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:ModernControls">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/ModernControls;component/Themes/MColors.xaml" />
        <ResourceDictionary Source="/ModernControls;component/Themes/MTitleBarButtonStyle.xaml" />
        <ResourceDictionary Source="/ModernControls;component/Themes/MStatusBarStyle.xaml" />
    </ResourceDictionary.MergedDictionaries>
    <Style x:Key="{x:Type local:MWindow}" TargetType="{x:Type local:MWindow}">
        <Setter Property="SnapsToDevicePixels" Value="true" />
        <Setter Property="AllowsTransparency" Value="true" />
        <Setter Property="WindowStyle" Value="None" />
        <Setter Property="ResizeMode" Value="CanResizeWithGrip" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:MWindow}">
                    <Grid TextOptions.TextRenderingMode="ClearType" TextOptions.TextFormattingMode="Display" Margin="7">
                        <Border x:Name="PART_Border">
                            <Border.Effect>
                                <DropShadowEffect Color="black" Opacity="0.5" BlurRadius="7" ShadowDepth="2" Direction="315"/>
                            </Border.Effect>
                            <DockPanel HorizontalAlignment="Stretch" Background="Transparent" VerticalAlignment="Stretch">
                                <StatusBar
                                    DockPanel.Dock="Bottom"
                                    Height="24">
                                    <TextBlock Margin="3,0,0,0">Ready</TextBlock>
                                    <StatusBarItem HorizontalAlignment="Right">
                                        <ResizeGrip Opacity="0.75" />
                                    </StatusBarItem>
                                </StatusBar>
                                <Border
                                    x:Name="TitleBar"
                                    DockPanel.Dock="Top"
                                    Background="{StaticResource BackgroundColorBrush}"
                                    BorderThickness="0" 
                                    >
                                    <Grid VerticalAlignment="Center" Height="30">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="30"/>
                                            <ColumnDefinition Width="30"/>
                                            <ColumnDefinition Width="30"/>
                                            <ColumnDefinition Width="30"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock x:Name="Caption" Grid.Column="1" Foreground="{StaticResource BasicFontColorBrush}"
                                                       HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,0,0,0"
                                                        FontFamily="Segoe UI" FontSize="24" Opacity="1" 
                                                       Text="{Binding Title, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                       />

                                        <Button x:Name="SettingsButton"  Grid.Column="2" Style="{StaticResource MTitleBarButtonStyle}">
                                            <Path Width="20" Height="20" Stretch="Fill" Fill="White" Data="F1 M 38,34.8333C 39.7489,34.8333 41.1667,36.2511 41.1667,38C 41.1667,39.7489 39.7489,41.1667 38,41.1667C 36.2511,41.1667 34.8333,39.7489 34.8333,38C 34.8333,36.2511 36.2511,34.8333 38,34.8333 Z M 39.0926,27.7941L 44.1899,23.4223C 45.1468,23.8291 46.0554,24.3274 46.9048,24.9062L 45.9892,31.5559L 52.685,32.0689C 53.068,33.0162 53.362,34.009 53.5566,35.037L 48.2059,39.0926L 52.5777,44.1899C 52.1709,45.1468 51.6726,46.0554 51.0938,46.9048L 44.4441,45.9892L 43.9311,52.685C 42.9838,53.068 41.9909,53.3619 40.963,53.5565L 36.9074,48.2059L 31.8101,52.5777C 30.8532,52.1709 29.9446,51.6726 29.0952,51.0938L 30.0108,44.4441L 23.315,43.931C 22.932,42.9837 22.638,41.9909 22.4434,40.963L 27.7941,36.9074L 23.4223,31.8101C 23.8291,30.8532 24.3274,29.9446 24.9062,29.0952L 31.5559,30.0108L 32.0689,23.315C 33.0162,22.932 34.0091,22.638 35.037,22.4434L 39.0926,27.7941 Z M 38,31.6667C 34.5022,31.6667 31.6667,34.5022 31.6667,38C 31.6667,41.4978 34.5022,44.3333 38,44.3333C 41.4978,44.3333 44.3333,41.4978 44.3333,38C 44.3333,34.5022 41.4978,31.6667 38,31.6667 Z "/>
                                        </Button>

                                        <Button x:Name="MinButton" Grid.Column="3" Style="{StaticResource MTitleBarButtonStyle}"
                                                >
                                            <Grid MaxHeight="9" MaxWidth="9">
                                                <Path
                                                Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                                                StrokeThickness="1"
                                                Stretch="None"
                                                RenderOptions.EdgeMode="Aliased"
                                                Data="M0,8 H8 M0,7 H8 M0,6 H8"
                                                />
                                            </Grid>
                                        </Button>

                                        <Button Grid.Column="4" x:Name="MaxButton" Style="{StaticResource MTitleBarButtonStyle}" >
                                            <Grid MaxHeight="9" MaxWidth="9">
                                                <Path
                                                x:Name="PART_MaxButton_Path"
                                                Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                                                StrokeThickness="1"
                                                Stretch="None"
                                                RenderOptions.EdgeMode="Aliased"
                                                Data="M0,0 H8 V8 H0 V0 M0,1 H8 M0,2 H8"
                                                />
                                            </Grid>
                                        </Button>

                                        <Button Grid.Column="5" x:Name="CloseButton" Style="{StaticResource MTitleBarButtonStyle}"                                                
                                                >
                                            <Grid MaxHeight="9" MaxWidth="9">
                                                <Path
                                                Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                                                StrokeThickness="1.5"
                                                Stretch="None"
                                                Data="M0,0 L8,8 M0,8 L8,0"
                                                />
                                            </Grid>
                                        </Button>
                                    </Grid>
                                </Border>
                                <Grid Background="{StaticResource BackgroundColorBrush}" >
                                    <ContentPresenter />
                                    <!--  <Frame Source="Aside.xaml" LoadCompleted="AsideLoad"/>-->
                                </Grid>
                            </DockPanel>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="WindowState" Value="Maximized">
                            <Setter TargetName="PART_MaxButton_Path" Property="Data" Value="M0,3 H5 V8 H0 V3 M0,4 H5 M3,0 H8 V5 H7 M3,1 H8"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
</ResourceDictionary>